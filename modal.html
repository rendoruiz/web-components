<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Modal</title>

  <style>
    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body{
      height: 120vh;
      display: grid;
      place-items: center;
      background: orange;
      user-select: none;
      
      font-family: sans-serif;
      text-align: center;
      line-height: 1.5;
    }

    .box {
      display: grid;
      gap: 5vh;
      place-items: center;
    }

    .btn {
      background: white;
      padding: 5px 20px;
      font-family: sans-serif;
      text-transform: uppercase;
      font-size: 2rem;
      border: none;
      border-radius: 0;
      cursor: pointer;

      --opening-tag: '';
      --closing-tag: '';
      display: flex;
      align-items: center;
    }
    .btn::before,
    .btn::after {
      letter-spacing: 2px;
      font-size: 1rem;
      text-transform: none;
    }

    .btn::before {
      margin-right: 5px;
      content: var(--opening-tag);
    }
    .btn::after {
      margin-left: 5px;
      content: var(--closing-tag);
    }
    .box .btn {
      color: orange;
    }

    h1 {
      text-transform: uppercase;
      font-size: 3rem;
      margin-bottom: 30px;
    }
    a {
      text-decoration: none;
    }


    /* MODAL CSS COMPONENTS START */
    body[data-modal-status="open"] {
      overflow: hidden;
    }

    .modal-group {
      --modal-group-smoke-color: rgba(30, 30, 30, 0.7);

      position: fixed;
      z-index: -10000;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      display: grid;
      place-items: center;
      overflow: scroll;
      background: var(--modal-group-smoke-color);
      opacity: 0;
      animation-duration: 0.5s;
      animation-fill-mode: both;
    }

    body[data-modal-status="open"] .modal-group {
      opacity: 1;
      z-index: 10000;
      animation-name: modal-group-open;
    }

    body[data-modal-status="close"] .modal-group {
      opacity: 0;
      z-index: -10000;
      animation-name: modal-group-close;
      pointer-events: none;
    }

    @keyframes modal-group-open {
      from {
        z-index: -10000;
        opacity: 0;
      }
      to {
        z-index: 10000;
        opacity: 1;
      }
    }
    @keyframes modal-group-close {
      from {
        z-index: 10000;
        opacity: 1;
      }
      to {
        z-index: -10000;
        opacity: 0;
      }
    }


    .modal-item {
      --modal-item-max-width: 90%;
      --modal-item-max-height: 90%;
      --modal-item-width: max(250px, var(--modal-item-max-width));
      --modal-item-height: max(250px, var(--modal-item-max-height));
      --modal-item-margin: 20px 10px;
      --modal-item-padding: 30px 10px;
      --modal-item-border-radius: 10px;
      --modal-item-background: cyan;

      width: var(--modal-item-width);
      height: var(--modal-item-height);
      margin: var(--modal-item-margin);
      padding: var(--modal-item-padding);
      border-radius: var(--modal-item-border-radius);
      background: var(--modal-item-background);
      display: none;
      opacity: 0;
      animation-duration: 0.5s;
      animation-fill-mode: both;
    }
    .modal-item[data-modal-active] {
      display: grid;
      align-content: center;
      justify-items: center;
    }

    body[data-modal-status="open"] .modal-item[data-modal-status="open"] {
      animation-name: modal-object-open;
    }
    body[data-modal-status="close"] .modal-item[data-modal-status="close"] {
      animation-name: modal-object-close;
      pointer-events: none;
    }

    @keyframes modal-object-open {
      from {
        transform: scale(1.2);
        opacity: 0;
      }
      to {
        transform: none;
        opacity: 1;
      }
    }
    @keyframes modal-object-close {
      from {
        transform: none;
        opacity: 1;
      }
      75% {
        transform: scale(1.2);
      }
      90% {
        opacity: 0;
      }
      to {
        transform: none;
      }
    }

    /* MODAL CSS COMPONENTS END */

  </style>
</head>
<body>
  <div class="box">
    <a 
      href="#" 
      class="btn" 
      style="--opening-tag: '<a>'; --closing-tag: '</a>'" 
      data-modal-open="1"
    >
      open modal 1
    </a>
    <button 
      class="btn" 
      style="--opening-tag: '<button>'; --closing-tag: '</button>'" data-modal-open="two"
    >
      open modal two
    </button>
    <span 
      class="btn" 
      style="--opening-tag: '<span>'; --closing-tag: '</span>'" data-modal-open="1"
    >
      open modal 1
    </span>
  </div>

  <div class="modal-group">
    <div 
      class="modal-item" 
      data-modal-id="1"
    >
      <h1>modal 1</h1>
      <span 
        class="btn" 
        data-modal-close="1"
      >
        close modal
      </span>
    </div>
    <div 
      class="modal-item" 
      data-modal-id="two"
    >
      <h1>modal two</h1>
      <span>Lorem ipsum dolor sit amet consectetur adipisicing elit. Culpa consequatur cupiditate voluptas esse quos architecto enim ut harum quae? Dicta est explicabo corrupti necessitatibus odio beatae quaerat asperiores. Quibusdam omnis repudiandae aspernatur et natus iure veniam voluptate nisi necessitatibus animi assumenda dolorem quae excepturi obcaecati reprehenderit impedit fugiat deleniti eligendi sint similique voluptas, sit architecto quaerat. Cum, consequatur vitae. Ut ea a molestias magni officia culpa deleniti blanditiis voluptatem, pariatur earum exercitationem error eos. Rerum accusantium optio possimus debitis expedita error quam suscipit atque fugiat ducimus architecto, tempore ullam fugit assumenda odio soluta inventore facere illo aliquam illum aspernatur corrupti maiores. Aliquid nesciunt ratione aut sequi, voluptatum perferendis ut nostrum aperiam libero nisi? Eum necessitatibus ullam sapiente quod omnis voluptatibus fugiat ratione distinctio incidunt repellat quo, explicabo impedit molestias iste! Explicabo, nihil facilis. Voluptatibus autem dicta recusandae molestias placeat accusamus tenetur! Qui praesentium ab repellendus, iusto, alias quibusdam itaque vel cupiditate perferendis aspernatur corporis, dolores temporibus corrupti nostrum quo earum nulla dignissimos illo nesciunt nam? Aut vero fugiat nobis quisquam. Aliquam quis culpa atque distinctio quia eum debitis architecto at rerum libero sit recusandae amet modi est dolorem aut itaque voluptatibus laborum, tempora nobis sapiente. Exercitationem inventore ullam magnam veniam!</span>
      <span 
        class="btn" 
        data-modal-close="two"
      >
        close modal
      </span>
    </div>
  </div>

  <script>
    // custom log.message()
    const enableLogMessages = true;
    const logMessages = (messages, isError = true) => {
      if (enableLogMessages) {
        if (!Array.isArray(messages)) {
          messages = [messages]
        }
        messages.forEach(message => {
          if (isError) {
            console.error('Modal Error:', message);
          }
          else {
            console.log('Modal:', message);
          }
        });
      }
    }

    const body = document.body;
    const modalGroup = document.querySelector('.modal-group');
    const modalIdAttribute = 'data-modal-id';
    const modalItems = [...modalGroup.children].filter(item => item.classList.contains('modal-item') && item.hasAttribute(modalIdAttribute));

    // check if modal-group and modal-item children exists
    let errorList = [];
    if (!modalGroup) {
      errorList.push('no element with [modal-group] class found.');
    }
    if (!modalItems || modalItems.length === 0) {
      errorList.push('no element with [modal-item] class found inside "modal-group".');
    }
    if (errorList.length > 0) {
      logMessages(errorList);
    }
    else {
      const modalStatusIndicatorAttribute = 'data-modal-status';
      const modalOpenedIndicator = 'open';
      const modalClosedIndicator = 'close';

      modalItems.forEach(item => {
        const modalId = item.getAttribute(modalIdAttribute);
        // check if modal item id is unique
        const itemInstance = modalItems.filter(i => i.hasAttribute(modalIdAttribute) === modalId);
        if (itemInstance.length > 1) {
          logMessages(`[${modalIdAttribute}] of each [modal-item] must be unique. all modal-item with [${modalIdAttribute}="${modalId}"] are skipped and not functional.`);
        }
        else {
          const itemActivators = document.querySelectorAll(`*[data-modal-open="${modalId}"]`);
          const itemDeactivators = item.querySelectorAll(`*[data-modal-close="${modalId}"]`);
          
          errorList = [];
          if (!itemActivators || itemActivators.length === 0) {
            errorList.push(`no element with [data-modal-open="${modalId}"] found. modal-item with [${modalIdAttribute}="${modalId}"] will be skipped and not functional.`)
          }
          if (!itemDeactivators || itemDeactivators.length === 0) {
            errorList.push(`no element with [data-modal-close="${modalId}"] found. modal-item with [${modalIdAttribute}="${modalId}"] will be skipped and not functional.`)
          }
          if (errorList.length > 0) {
            logMessages(errorList);
          }
          else {
            itemActivators.forEach(activator => {
              activator.addEventListener('click', (e) => {
                e.preventDefault();
                e.stopPropagation();

                // set data-modal-active for current item and clear for others
                const modalActiveIndicatorAttribute = 'data-modal-active';
                const otherModals = modalItems.filter(i => i !== itemInstance);
                otherModals.forEach(i => i.removeAttribute(modalActiveIndicatorAttribute));
                item.setAttribute(modalActiveIndicatorAttribute, 'true');

                // set modal-item and body status to open
                body.setAttribute(modalStatusIndicatorAttribute, modalOpenedIndicator);
                item.setAttribute(modalStatusIndicatorAttribute, modalOpenedIndicator);

                logMessages(`[id=${modalId}] modal opened by an activator`, false);
              });
            });

            itemDeactivators.forEach(deactivator => {
              deactivator.addEventListener('click', (e) => {
                e.preventDefault();
                e.stopPropagation();

                // set modal-item and body status to close
                body.setAttribute(modalStatusIndicatorAttribute, modalClosedIndicator);
                item.setAttribute(modalStatusIndicatorAttribute, modalClosedIndicator);

                logMessages(`[id=${modalId}] modal closed by a deactivator`, false);
              });
            });
          }
        }
      });

      // deactivate opened model-item whenever modal-group is clicked
      modalGroup.addEventListener('click', (e) => {
        if (e.target === modalGroup &&
          body.dataset.modalStatus === 'open') {
          const activeModal = document.querySelector(`.modal-item[${modalStatusIndicatorAttribute}="open"]`);
          if (activeModal) {
            // set modal-item and body status to close
            body.setAttribute(modalStatusIndicatorAttribute, modalClosedIndicator);
            activeModal.setAttribute(modalStatusIndicatorAttribute, modalClosedIndicator);

            logMessages(`[id=${activeModal.getAttribute(modalIdAttribute)}] modal closed by modal-group`, false);
          }
        }
      })
    }
  </script>
</body>
</html>